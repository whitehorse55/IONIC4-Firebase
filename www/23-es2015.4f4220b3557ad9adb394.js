(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"1m1N":function(l,n,e){"use strict";e.r(n);var i=e("8Y7J"),u=e("mrSG"),t=e("ZZ/e"),o=e("s7LF"),r=e("y24p"),s=e("t8sF"),a=e("Pn9U"),c=e("t4gJ"),g=e("jfHL"),b=e("iqUP");class m{constructor(l,n,e,i,u,t,o,r,s,a,c,g){this.crop=l,this.file=n,this.camera=e,this.navCtrl=i,this.formBuilder=u,this.toastCtrl=t,this.alertCtrl=o,this.loadingCtrl=r,this.afs=s,this.af=a,this.offerService=c,this.userService=g,this.defaultImage="assets/img/frame.png",this.isLoading=!1,this.imagePickerOptions={maximumImagesCount:1,quality:50},this.validationMessages={description:[{type:"required",message:"Description is required."},{type:"maxlength",message:"Description must be upto 150 characters long."}]}}ngOnInit(){this.newOfferForm=this.formBuilder.group({description:[null,o.l.compose([o.l.required,o.l.maxLength(150)])]}),this.imageResponse=[],this.sectorsarray=[],this.selectedSectors=[],this.uploadedFiles=[],this.generateSectorsArray()}generateSectorsArray(){for(let l=0;l<17;l++)this.sectorsarray.push("sector"+l)}clickSector(l){this.selectedSectors.includes(l)?this.selectedSectors.splice(this.selectedSectors.indexOf(l),1):this.selectedSectors.push(l)}takePicture(){this.imageResponse.length>=3?this.showToast():this.camera.getPicture({quality:50,destinationType:this.camera.DestinationType.FILE_URI,encodingType:this.camera.EncodingType.JPEG,mediaType:this.camera.MediaType.PICTURE}).then(l=>{this.cropImage(l)})}showToast(){return u.__awaiter(this,void 0,void 0,function*(){(yield this.toastCtrl.create({showCloseButton:!1,message:"Image can add upto 3",duration:3e3,position:"bottom"})).present()})}getImages(){this.imageResponse.length>=3?this.showToast():this.camera.getPicture({quality:50,destinationType:this.camera.DestinationType.FILE_URI,encodingType:this.camera.EncodingType.JPEG,mediaType:this.camera.MediaType.PICTURE,sourceType:this.camera.PictureSourceType.PHOTOLIBRARY}).then(l=>{this.cropImage(l)})}cropImage(l){this.crop.crop(l,{targetHeight:180,targetWidth:240,quality:50}).then(l=>{this.showCroppedImage(l.split("?")[0])},l=>{alert("Error cropping image"+l)})}showCroppedImage(l){this.isLoading=!0;const n=l.split("/"),e=n[n.length-1],i=l.split(e)[0];this.file.readAsDataURL(i,e).then(l=>{this.imageResponse.push(l),this.isLoading=!1},l=>{alert("Error in showing image"+l),this.isLoading=!1})}removeImage(l){this.imageResponse.splice(l-1,1)}offerPublish(){this.uploadImage()}uploadImage(){this.loadingCtrl.create({message:"Please wait..."}).then(l=>{l.present(),l.onDidDismiss().then(l=>{console.log("Loading dismissed!")})});for(let l=0;l<this.imageResponse.length;l++){const n="offer/"+l+(new Date).getTime()+".jpg",e=this.afs.ref(n);console.log(this.imageResponse[l]),e.putString(this.imageResponse[l],"data_url").then(()=>{e.getDownloadURL().subscribe(l=>{this.uploadedFiles.push(l),this.uploadedFiles.length===this.imageResponse.length&&this.doPublish()})}).catch(l=>u.__awaiter(this,void 0,void 0,function*(){console.log(l),(yield this.toastCtrl.create({showCloseButton:!0,message:l,duration:3e3,position:"bottom"})).present()}))}}doPublish(){const l=this.userService.getAuthUser().uid;this.userService.getUser(l).subscribe(l=>{this.newOffer={companyId:l.id,companyName:l.name,companyAvatar:l.avatar,description:this.newOfferForm.value.description,media:this.uploadedFiles,sectors:this.selectedSectors,timestamp:b.firestore.FieldValue.serverTimestamp()},this.offerService.addOffer(this.newOffer),this.loadingCtrl.dismiss(),this.navCtrl.pop()})}}class p{}var h=e("pMnS"),d=e("SVse"),f=e("oBZk"),k=e("gJ2e"),x=e("Xr7G"),v=i.pb({encapsulation:0,styles:[["[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{--background:linear-gradient(135deg, var(--ion-color-primary-contrast), var(--ion-color-primary))}ion-item[_ngcontent-%COMP%]{border-radius:5px;margin-top:10px;margin-left:20px;margin-right:20px}ion-item[_ngcontent-%COMP%]:first-child{margin-top:5vh}ion-item.item[_ngcontent-%COMP%]{background-color:rgba(255,255,255,.4);margin-bottom:1px}ion-item.item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{width:10%;color:rgba(0,0,0,.6);font-size:1.2em}.image-picker[_ngcontent-%COMP%]{margin-bottom:20px}.image-picker[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{display:-webkit-inline-box;display:inline-flex;margin:20px 20px 10px}.image-picker[_ngcontent-%COMP%]   ion-fab-button[_ngcontent-%COMP%]{width:30px;height:30px;margin-top:-4px}.image-picker[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto}.image-picker[_ngcontent-%COMP%]   .remove-media[_ngcontent-%COMP%]{position:absolute;right:5px;top:0;width:50px;height:50px}.sector-selector[_ngcontent-%COMP%]{position:absolute;right:10px;top:0;width:30px}.sector-picker[_ngcontent-%COMP%]{margin-top:20px}.sector-picker[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-left:20px;margin-right:20px}#publishBtn[_ngcontent-%COMP%]{margin:20px 20px 50px}.validation-errors[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px;color:#fff}"]],data:{}});function C(l){return i.Ib(0,[(l()(),i.rb(0,0,null,null,1,"div",[["class","error-message"]],null,null,null,null,null)),(l()(),i.Hb(1,null,[" "," "]))],null,function(l,n){l(n,1,0,n.parent.context.$implicit.message)})}function q(l){return i.Ib(0,[(l()(),i.rb(0,0,null,null,2,null,null,null,null,null,null,null)),(l()(),i.gb(16777216,null,null,1,null,C)),i.qb(2,16384,null,0,d.i,[i.M,i.J],{ngIf:[0,"ngIf"]},null),(l()(),i.gb(0,null,null,0))],function(l,n){var e=n.component;l(n,2,0,e.newOfferForm.get("description").hasError(n.context.$implicit.type)&&(e.newOfferForm.get("description").dirty||e.newOfferForm.get("description").touched))},null)}function y(l){return i.Ib(0,[(l()(),i.rb(0,0,null,null,1,"ion-icon",[["class","sector-selector"],["ios","ios-checkmark-circle"],["md","md-checkmark-circle"],["slot","icon-only"]],null,null,null,f.S,f.n)),i.qb(1,49152,null,0,t.B,[i.h,i.k,i.x],{ios:[0,"ios"],md:[1,"md"]},null)],function(l,n){l(n,1,0,"ios-checkmark-circle","md-checkmark-circle")},null)}function I(l){return i.Ib(0,[(l()(),i.rb(0,0,null,null,6,"ion-col",[["size","4"]],null,null,null,f.N,f.i)),i.qb(1,49152,null,0,t.s,[i.h,i.k,i.x],{size:[0,"size"]},null),(l()(),i.rb(2,0,null,0,4,"ion-button",[["expand","fill"],["fill","clear"],["size","large"]],null,[[null,"click"]],function(l,n,e){var i=!0;return"click"===n&&(i=!1!==l.component.clickSector(l.context.$implicit)&&i),i},f.J,f.e)),i.qb(3,49152,null,0,t.j,[i.h,i.k,i.x],{expand:[0,"expand"],fill:[1,"fill"],size:[2,"size"]},null),(l()(),i.rb(4,0,null,0,0,"img",[],[[8,"src",4]],null,null,null,null)),(l()(),i.gb(16777216,null,0,1,null,y)),i.qb(6,16384,null,0,d.i,[i.M,i.J],{ngIf:[0,"ngIf"]},null)],function(l,n){var e=n.component;l(n,1,0,"4"),l(n,3,0,"fill","clear","large"),l(n,6,0,e.selectedSectors.includes(n.context.$implicit))},function(l,n){l(n,4,0,i.vb(1,"assets/img/",n.context.$implicit,".png"))})}function P(l){return i.Ib(0,[(l()(),i.rb(0,0,null,null,1,"ion-icon",[["class","remove-media"],["name","trash"],["slot","icon-only"]],null,[[null,"click"]],function(l,n,e){var i=!0;return"click"===n&&(i=!1!==l.component.removeImage(1)&&i),i},f.S,f.n)),i.qb(1,49152,null,0,t.B,[i.h,i.k,i.x],{name:[0,"name"]},null)],function(l,n){l(n,1,0,"trash")},null)}function O(l){return i.Ib(0,[(l()(),i.rb(0,0,null,null,1,"ion-icon",[["class","remove-media"],["name","trash"],["slot","icon-only"]],null,[[null,"click"]],function(l,n,e){var i=!0;return"click"===n&&(i=!1!==l.component.removeImage(2)&&i),i},f.S,f.n)),i.qb(1,49152,null,0,t.B,[i.h,i.k,i.x],{name:[0,"name"]},null)],function(l,n){l(n,1,0,"trash")},null)}function w(l){return i.Ib(0,[(l()(),i.rb(0,0,null,null,1,"ion-icon",[["class","remove-media"],["name","trash"],["slot","icon-only"]],null,[[null,"click"]],function(l,n,e){var i=!0;return"click"===n&&(i=!1!==l.component.removeImage(3)&&i),i},f.S,f.n)),i.qb(1,49152,null,0,t.B,[i.h,i.k,i.x],{name:[0,"name"]},null)],function(l,n){l(n,1,0,"trash")},null)}function M(l){return i.Ib(0,[(l()(),i.rb(0,0,null,null,11,"ion-header",[],null,null,null,f.R,f.m)),i.qb(1,49152,null,0,t.A,[i.h,i.k,i.x],null,null),(l()(),i.rb(2,0,null,0,9,"ion-toolbar",[],null,null,null,f.jb,f.E)),i.qb(3,49152,null,0,t.Ab,[i.h,i.k,i.x],null,null),(l()(),i.rb(4,0,null,0,4,"ion-buttons",[["slot","start"]],null,null,null,f.K,f.f)),i.qb(5,49152,null,0,t.k,[i.h,i.k,i.x],null,null),(l()(),i.rb(6,0,null,0,2,"ion-back-button",[["defaultHref","/home/newOffers"]],null,[[null,"click"]],function(l,n,e){var u=!0;return"click"===n&&(u=!1!==i.Db(l,8).onClick(e)&&u),u},f.H,f.c)),i.qb(7,49152,null,0,t.f,[i.h,i.k,i.x],{defaultHref:[0,"defaultHref"]},null),i.qb(8,16384,null,0,t.g,[[2,t.gb],t.Hb],{defaultHref:[0,"defaultHref"]},null),(l()(),i.rb(9,0,null,0,2,"ion-title",[],null,null,null,f.ib,f.D)),i.qb(10,49152,null,0,t.yb,[i.h,i.k,i.x],null,null),(l()(),i.Hb(-1,0,["Offer Publications"])),(l()(),i.rb(12,0,null,null,68,"ion-content",[["id","offerpublication"]],null,null,null,f.O,f.j)),i.qb(13,49152,null,0,t.t,[i.h,i.k,i.x],null,null),(l()(),i.rb(14,0,null,0,66,"form",[["class","list-form"],["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],function(l,n,e){var u=!0,t=l.component;return"submit"===n&&(u=!1!==i.Db(l,16).onSubmit(e)&&u),"reset"===n&&(u=!1!==i.Db(l,16).onReset()&&u),"ngSubmit"===n&&(u=!1!==t.offerPublish()&&u),u},null,null)),i.qb(15,16384,null,0,o.p,[],null,null),i.qb(16,540672,null,0,o.d,[[8,null],[8,null]],{form:[0,"form"]},{ngSubmit:"ngSubmit"}),i.Eb(2048,null,o.a,null,[o.d]),i.qb(18,16384,null,0,o.i,[[4,o.a]],null,null),(l()(),i.rb(19,0,null,null,8,"ion-item",[["no-padding",""]],null,null,null,f.V,f.q)),i.qb(20,49152,null,0,t.G,[i.h,i.k,i.x],null,null),(l()(),i.rb(21,0,null,0,6,"ion-textarea",[["formControlName","description"],["item-end",""],["placeholder","Description (name of product, price, offer price, etc.)"],["row","5"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ionBlur"],[null,"ionChange"]],function(l,n,e){var u=!0;return"ionBlur"===n&&(u=!1!==i.Db(l,22)._handleBlurEvent(e.target)&&u),"ionChange"===n&&(u=!1!==i.Db(l,22)._handleInputEvent(e.target)&&u),u},f.hb,f.C)),i.qb(22,16384,null,0,t.Mb,[i.k],null,null),i.Eb(1024,null,o.f,function(l){return[l]},[t.Mb]),i.qb(24,671744,null,0,o.c,[[3,o.a],[8,null],[8,null],[6,o.f],[2,o.o]],{name:[0,"name"]},null),i.Eb(2048,null,o.g,null,[o.c]),i.qb(26,16384,null,0,o.h,[[4,o.g]],null,null),i.qb(27,49152,null,0,t.wb,[i.h,i.k,i.x],{placeholder:[0,"placeholder"]},null),(l()(),i.rb(28,0,null,null,2,"div",[["class","validation-errors"]],null,null,null,null,null)),(l()(),i.gb(16777216,null,null,1,null,q)),i.qb(30,278528,null,0,d.h,[i.M,i.J,i.q],{ngForOf:[0,"ngForOf"]},null),(l()(),i.rb(31,0,null,null,8,"div",[["class","sector-picker"]],null,null,null,null,null)),(l()(),i.rb(32,0,null,null,1,"label",[],null,null,null,null,null)),(l()(),i.Hb(-1,null,["Select your sectors"])),(l()(),i.rb(34,0,null,null,5,"ion-grid",[],null,null,null,f.Q,f.l)),i.qb(35,49152,null,0,t.z,[i.h,i.k,i.x],null,null),(l()(),i.rb(36,0,null,0,3,"ion-row",[],null,null,null,f.X,f.s)),i.qb(37,49152,null,0,t.hb,[i.h,i.k,i.x],null,null),(l()(),i.gb(16777216,null,0,1,null,I)),i.qb(39,278528,null,0,d.h,[i.M,i.J,i.q],{ngForOf:[0,"ngForOf"]},null),(l()(),i.rb(40,0,null,null,35,"div",[["class","image-picker"]],null,null,null,null,null)),(l()(),i.rb(41,0,null,null,9,"div",[],null,null,null,null,null)),(l()(),i.Hb(-1,null,[" Select multimedia to publish "])),(l()(),i.rb(43,0,null,null,3,"ion-fab-button",[["color","primary"],["size","small"]],null,[[null,"click"]],function(l,n,e){var i=!0;return"click"===n&&(i=!1!==l.component.takePicture()&&i),i},f.P,f.k)),i.qb(44,49152,null,0,t.w,[i.h,i.k,i.x],{color:[0,"color"],size:[1,"size"]},null),(l()(),i.rb(45,0,null,0,1,"ion-icon",[["name","camera"]],null,null,null,f.S,f.n)),i.qb(46,49152,null,0,t.B,[i.h,i.k,i.x],{name:[0,"name"]},null),(l()(),i.rb(47,0,null,null,3,"ion-fab-button",[["color","primary"],["size","small"]],null,[[null,"click"]],function(l,n,e){var i=!0;return"click"===n&&(i=!1!==l.component.getImages()&&i),i},f.P,f.k)),i.qb(48,49152,null,0,t.w,[i.h,i.k,i.x],{color:[0,"color"],size:[1,"size"]},null),(l()(),i.rb(49,0,null,0,1,"ion-icon",[["name","cloud-upload"]],null,null,null,f.S,f.n)),i.qb(50,49152,null,0,t.B,[i.h,i.k,i.x],{name:[0,"name"]},null),(l()(),i.rb(51,0,null,null,24,"ion-grid",[],null,null,null,f.Q,f.l)),i.qb(52,49152,null,0,t.z,[i.h,i.k,i.x],null,null),(l()(),i.rb(53,0,null,0,22,"ion-row",[],null,null,null,f.X,f.s)),i.qb(54,49152,null,0,t.hb,[i.h,i.k,i.x],null,null),(l()(),i.rb(55,0,null,0,6,"ion-col",[["size","4"]],null,null,null,f.N,f.i)),i.qb(56,49152,null,0,t.s,[i.h,i.k,i.x],{size:[0,"size"]},null),(l()(),i.rb(57,0,null,0,4,"div",[["expand","fill"],["fill","clear"],["size","large"]],null,null,null,null,null)),(l()(),i.rb(58,0,null,null,1,"ion-img",[],null,null,null,f.T,f.o)),i.qb(59,49152,null,0,t.C,[i.h,i.k,i.x],{src:[0,"src"]},null),(l()(),i.gb(16777216,null,null,1,null,P)),i.qb(61,16384,null,0,d.i,[i.M,i.J],{ngIf:[0,"ngIf"]},null),(l()(),i.rb(62,0,null,0,6,"ion-col",[["size","4"]],null,null,null,f.N,f.i)),i.qb(63,49152,null,0,t.s,[i.h,i.k,i.x],{size:[0,"size"]},null),(l()(),i.rb(64,0,null,0,4,"div",[["expand","fill"],["fill","clear"],["size","large"]],null,null,null,null,null)),(l()(),i.rb(65,0,null,null,1,"ion-img",[],null,null,null,f.T,f.o)),i.qb(66,49152,null,0,t.C,[i.h,i.k,i.x],{src:[0,"src"]},null),(l()(),i.gb(16777216,null,null,1,null,O)),i.qb(68,16384,null,0,d.i,[i.M,i.J],{ngIf:[0,"ngIf"]},null),(l()(),i.rb(69,0,null,0,6,"ion-col",[["size","4"]],null,null,null,f.N,f.i)),i.qb(70,49152,null,0,t.s,[i.h,i.k,i.x],{size:[0,"size"]},null),(l()(),i.rb(71,0,null,0,4,"div",[["expand","fill"],["fill","clear"],["size","large"]],null,null,null,null,null)),(l()(),i.rb(72,0,null,null,1,"ion-img",[],null,null,null,f.T,f.o)),i.qb(73,49152,null,0,t.C,[i.h,i.k,i.x],{src:[0,"src"]},null),(l()(),i.gb(16777216,null,null,1,null,w)),i.qb(75,16384,null,0,d.i,[i.M,i.J],{ngIf:[0,"ngIf"]},null),(l()(),i.rb(76,0,null,null,4,"ion-button",[["color","dark"],["expand","full"],["icon-left",""],["id","publishBtn"],["shape","round"],["size","medium"],["tappable",""],["type","submit"]],null,null,null,f.J,f.e)),i.qb(77,49152,null,0,t.j,[i.h,i.k,i.x],{color:[0,"color"],disabled:[1,"disabled"],expand:[2,"expand"],shape:[3,"shape"],size:[4,"size"],type:[5,"type"]},null),(l()(),i.rb(78,0,null,0,1,"ion-icon",[["name","cloud-upload"]],null,null,null,f.S,f.n)),i.qb(79,49152,null,0,t.B,[i.h,i.k,i.x],{name:[0,"name"]},null),(l()(),i.Hb(-1,0,[" Publish "]))],function(l,n){var e=n.component;l(n,7,0,"/home/newOffers"),l(n,8,0,"/home/newOffers"),l(n,16,0,e.newOfferForm),l(n,24,0,"description"),l(n,27,0,"Description (name of product, price, offer price, etc.)"),l(n,30,0,e.validationMessages.description),l(n,39,0,e.sectorsarray),l(n,44,0,"primary","small"),l(n,46,0,"camera"),l(n,48,0,"primary","small"),l(n,50,0,"cloud-upload"),l(n,56,0,"4"),l(n,59,0,e.imageResponse.length>0?e.imageResponse[0]:e.defaultImage),l(n,61,0,e.imageResponse.length>0),l(n,63,0,"4"),l(n,66,0,e.imageResponse.length>1?e.imageResponse[1]:e.defaultImage),l(n,68,0,e.imageResponse.length>1),l(n,70,0,"4"),l(n,73,0,e.imageResponse.length>2?e.imageResponse[2]:e.defaultImage),l(n,75,0,e.imageResponse.length>2),l(n,77,0,"dark",!e.newOfferForm.valid,"full","round","medium","submit"),l(n,79,0,"cloud-upload")},function(l,n){l(n,14,0,i.Db(n,18).ngClassUntouched,i.Db(n,18).ngClassTouched,i.Db(n,18).ngClassPristine,i.Db(n,18).ngClassDirty,i.Db(n,18).ngClassValid,i.Db(n,18).ngClassInvalid,i.Db(n,18).ngClassPending),l(n,21,0,i.Db(n,26).ngClassUntouched,i.Db(n,26).ngClassTouched,i.Db(n,26).ngClassPristine,i.Db(n,26).ngClassDirty,i.Db(n,26).ngClassValid,i.Db(n,26).ngClassInvalid,i.Db(n,26).ngClassPending)})}function S(l){return i.Ib(0,[(l()(),i.rb(0,0,null,null,1,"app-offerpublication",[],null,null,null,M,v)),i.qb(1,114688,null,0,m,[r.a,s.a,a.a,t.Hb,o.b,t.Nb,t.a,t.Eb,k.a,x.a,c.a,g.a],null,null)],function(l,n){l(n,1,0)},null)}var B=i.nb("app-offerpublication",m,S,{},{},[]),D=e("iInd");e.d(n,"OfferpublicationPageModuleNgFactory",function(){return _});var _=i.ob(p,[],function(l){return i.Ab([i.Bb(512,i.j,i.Z,[[8,[h.a,B]],[3,i.j],i.v]),i.Bb(4608,d.k,d.j,[i.s,[2,d.q]]),i.Bb(4608,o.n,o.n,[]),i.Bb(4608,t.b,t.b,[i.x,i.g]),i.Bb(4608,t.Gb,t.Gb,[t.b,i.j,i.p]),i.Bb(4608,t.Jb,t.Jb,[t.b,i.j,i.p]),i.Bb(4608,o.b,o.b,[]),i.Bb(1073742336,d.b,d.b,[]),i.Bb(1073742336,o.m,o.m,[]),i.Bb(1073742336,o.e,o.e,[]),i.Bb(1073742336,t.Cb,t.Cb,[]),i.Bb(1073742336,o.k,o.k,[]),i.Bb(1073742336,D.o,D.o,[[2,D.t],[2,D.m]]),i.Bb(1073742336,p,p,[]),i.Bb(1024,D.k,function(){return[[{path:"",component:m}]]},[])])})}}]);